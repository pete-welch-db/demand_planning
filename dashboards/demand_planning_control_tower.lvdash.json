{
  "datasets": [
    {
      "name": "kpi_snapshot",
      "displayName": "KPI Snapshot (13w)",
      "queryLines": [
        "WITH kpi AS (",
        "  SELECT MEASURE(`OTIF`) AS otif_rate,",
        "         MEASURE(`Freight $/ton`) AS freight_cost_per_ton,",
        "         MEASURE(`Premium freight %`) AS premium_freight_pct,",
        "         MEASURE(`CO2 kg/ton`) AS co2_kg_per_ton,",
        "         MEASURE(`Energy kWh/unit`) AS energy_kwh_per_unit",
        "  FROM welch.demand_planning_demo.mv_control_tower_kpis",
        "  WHERE week >= date_sub(current_date(), 91)",
        "), ",
        "risk AS (",
        "  SELECT MEASURE(`Avg late-risk prob`) AS late_risk_prob",
        "  FROM welch.demand_planning_demo.mv_late_delivery_risk",
        "  WHERE order_date >= date_sub(current_date(), 91)",
        "), ",
        "mape AS (",
        "  SELECT MEASURE(`MAPE`) AS mape",
        "  FROM welch.demand_planning_demo.mv_forecast_accuracy",
        "  WHERE week >= date_sub(current_date(), 91)",
        ") ",
        "SELECT kpi.*, risk.late_risk_prob, mape.mape ",
        "FROM kpi CROSS JOIN risk CROSS JOIN mape"
      ]
    },
    {
      "name": "otif_trend",
      "displayName": "OTIF Trend (Weekly)",
      "queryLines": [
        "SELECT week, region, MEASURE(`OTIF`) AS otif_rate ",
        "FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "GROUP BY week, region ",
        "ORDER BY week, region"
      ]
    },
    {
      "name": "sustainability_trend",
      "displayName": "Sustainability Metrics (Weekly)",
      "queryLines": [
        "SELECT week, ",
        "       MEASURE(`CO2 kg/ton`) AS co2_kg_per_ton, ",
        "       MEASURE(`Energy kWh/unit`) AS energy_kwh_per_unit, ",
        "       MEASURE(`Premium freight %`) AS premium_freight_pct ",
        "FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "WHERE (:selected_region IS NULL OR region = :selected_region) ",
        "GROUP BY week ",
        "ORDER BY week"
      ]
    },
    {
      "name": "co2_by_region",
      "displayName": "CO2 by Region",
      "queryLines": [
        "SELECT region, ",
        "       MEASURE(`CO2 kg/ton`) AS co2_kg_per_ton, ",
        "       MEASURE(`Freight $/ton`) AS freight_cost_per_ton ",
        "FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "WHERE week >= date_sub(current_date(), 91) ",
        "GROUP BY region ",
        "ORDER BY co2_kg_per_ton DESC"
      ]
    },
    {
      "name": "region_list",
      "displayName": "Region List",
      "queryLines": [
        "SELECT DISTINCT region FROM welch.demand_planning_demo.mv_control_tower_kpis ORDER BY region"
      ]
    },
    {
      "name": "sust_kpi_snapshot",
      "displayName": "Sustainability KPI Snapshot (filtered)",
      "queryLines": [
        "SELECT MEASURE(`CO2 kg/ton`) AS co2_kg_per_ton, ",
        "       MEASURE(`Energy kWh/unit`) AS energy_kwh_per_unit, ",
        "       MEASURE(`Premium freight %`) AS premium_freight_pct, ",
        "       MEASURE(`Freight $/ton`) AS freight_cost_per_ton ",
        "FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "WHERE week >= date_sub(current_date(), 91) AND (:selected_region IS NULL OR region = :selected_region)"
      ]
    },
    {
      "name": "energy_by_plant",
      "displayName": "Energy by Plant",
      "queryLines": [
        "SELECT plant_id, MEASURE(`Energy kWh/unit`) AS energy_kwh_per_unit ",
        "FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "WHERE week >= date_sub(current_date(), 91) AND (:selected_region IS NULL OR region = :selected_region) ",
        "GROUP BY plant_id ",
        "ORDER BY energy_kwh_per_unit DESC"
      ]
    },
    {
      "name": "freight_lanes_13w",
      "displayName": "Freight Lanes (13w)",
      "queryLines": [
        "SELECT plant_id, dc_id, ",
        "       MEASURE(`Freight $/ton`) AS freight_cost_per_ton, ",
        "       MEASURE(`Premium freight %`) AS premium_freight_pct, ",
        "       MEASURE(`CO2 kg/ton`) AS co2_kg_per_ton ",
        "FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "WHERE week >= date_sub(current_date(), 91) ",
        "GROUP BY plant_id, dc_id ",
        "ORDER BY freight_cost_per_ton DESC ",
        "LIMIT 20"
      ]
    },
    {
      "name": "mape_trend",
      "displayName": "MAPE Trend (Weekly)",
      "queryLines": [
        "SELECT week, MEASURE(`MAPE`) AS mape ",
        "FROM welch.demand_planning_demo.mv_forecast_accuracy ",
        "WHERE (:fc_region IS NULL OR region = :fc_region) AND (:fc_sku_family IS NULL OR sku_family = :fc_sku_family) ",
        "GROUP BY week ",
        "ORDER BY week"
      ]
    },
    {
      "name": "mape_by_family_region",
      "displayName": "MAPE by Family/Region",
      "queryLines": [
        "SELECT sku_family, region, MEASURE(`MAPE`) AS mape ",
        "FROM welch.demand_planning_demo.mv_forecast_accuracy ",
        "WHERE week >= date_sub(current_date(), 91) AND (:fc_region IS NULL OR region = :fc_region) AND (:fc_sku_family IS NULL OR sku_family = :fc_sku_family) ",
        "GROUP BY sku_family, region ",
        "ORDER BY mape DESC"
      ]
    },
    {
      "name": "fc_region_list",
      "displayName": "Forecast Region List",
      "queryLines": [
        "SELECT DISTINCT region FROM welch.demand_planning_demo.mv_forecast_accuracy ORDER BY region"
      ]
    },
    {
      "name": "fc_sku_family_list",
      "displayName": "Forecast SKU Family List",
      "queryLines": [
        "SELECT DISTINCT sku_family FROM welch.demand_planning_demo.mv_forecast_accuracy ORDER BY sku_family"
      ]
    },
    {
      "name": "fc_kpi_snapshot",
      "displayName": "Forecast KPI Snapshot (filtered)",
      "queryLines": [
        "SELECT MEASURE(`MAPE`) AS mape, ",
        "       COUNT(DISTINCT week) AS weeks_analyzed, ",
        "       COUNT(DISTINCT CONCAT(sku_family, region)) AS combinations ",
        "FROM welch.demand_planning_demo.mv_forecast_accuracy ",
        "WHERE week >= date_sub(current_date(), 91) AND (:fc_region IS NULL OR region = :fc_region) AND (:fc_sku_family IS NULL OR sku_family = :fc_sku_family)"
      ]
    },
    {
      "name": "mape_by_region",
      "displayName": "MAPE by Region",
      "queryLines": [
        "SELECT region, MEASURE(`MAPE`) AS mape ",
        "FROM welch.demand_planning_demo.mv_forecast_accuracy ",
        "WHERE week >= date_sub(current_date(), 91) AND (:fc_sku_family IS NULL OR sku_family = :fc_sku_family) ",
        "GROUP BY region ",
        "ORDER BY mape DESC"
      ]
    },
    {
      "name": "mape_by_family",
      "displayName": "MAPE by Product Family",
      "queryLines": [
        "SELECT sku_family, MEASURE(`MAPE`) AS mape ",
        "FROM welch.demand_planning_demo.mv_forecast_accuracy ",
        "WHERE week >= date_sub(current_date(), 91) AND (:fc_region IS NULL OR region = :fc_region) ",
        "GROUP BY sku_family ",
        "ORDER BY mape DESC"
      ]
    },
    {
      "name": "forecast_bias",
      "displayName": "Forecast Bias Analysis",
      "queryLines": [
        "SELECT a.week, a.sku_family, a.region, SUM(a.actual_units) AS actual_units, SUM(f.forecast_units) AS forecast_units, SUM(f.forecast_units) - SUM(a.actual_units) AS bias, CASE WHEN SUM(a.actual_units) > 0 THEN ROUND((SUM(f.forecast_units) - SUM(a.actual_units)) / SUM(a.actual_units) * 100, 1) ELSE 0 END AS bias_pct ",
        "FROM welch.demand_planning_demo.weekly_demand_actual a ",
        "LEFT JOIN welch.demand_planning_demo.demand_forecast f USING (week, sku_family, region) ",
        "WHERE a.week >= date_sub(current_date(), 91) AND (:fc_region IS NULL OR a.region = :fc_region) AND (:fc_sku_family IS NULL OR a.sku_family = :fc_sku_family) ",
        "GROUP BY a.week, a.sku_family, a.region ORDER BY a.week"
      ]
    },
    {
      "name": "forecast_bias_summary",
      "displayName": "Forecast Bias Summary",
      "queryLines": [
        "SELECT SUM(CASE WHEN f.forecast_units > a.actual_units THEN 1 ELSE 0 END) AS over_forecast_count, SUM(CASE WHEN f.forecast_units < a.actual_units THEN 1 ELSE 0 END) AS under_forecast_count, ROUND(AVG((f.forecast_units - a.actual_units) / NULLIF(a.actual_units, 0) * 100), 1) AS avg_bias_pct ",
        "FROM welch.demand_planning_demo.weekly_demand_actual a ",
        "LEFT JOIN welch.demand_planning_demo.demand_forecast f USING (week, sku_family, region) ",
        "WHERE a.week >= date_sub(current_date(), 91) AND (:fc_region IS NULL OR a.region = :fc_region) AND (:fc_sku_family IS NULL OR a.sku_family = :fc_sku_family)"
      ]
    },
    {
      "name": "worst_forecasts",
      "displayName": "Worst Forecast Combinations",
      "queryLines": [
        "SELECT sku_family, region, MEASURE(`MAPE`) AS mape ",
        "FROM welch.demand_planning_demo.mv_forecast_accuracy ",
        "WHERE week >= date_sub(current_date(), 91) AND (:fc_region IS NULL OR region = :fc_region) AND (:fc_sku_family IS NULL OR sku_family = :fc_sku_family) ",
        "GROUP BY sku_family, region ",
        "ORDER BY mape DESC ",
        "LIMIT 10"
      ]
    },
    {
      "name": "late_risk_trend",
      "displayName": "Late Risk Trend (Weekly)",
      "queryLines": [
        "SELECT order_week, ",
        "       MEASURE(`Avg late-risk prob`) AS avg_late_risk, ",
        "       MEASURE(`Observed late rate`) AS actual_late_rate ",
        "FROM welch.demand_planning_demo.mv_late_delivery_risk ",
        "GROUP BY order_week ",
        "ORDER BY order_week"
      ]
    },
    {
      "name": "late_risk_by_region",
      "displayName": "Late Risk by Region",
      "queryLines": [
        "SELECT customer_region, ",
        "       MEASURE(`Avg late-risk prob`) AS avg_late_risk, ",
        "       MEASURE(`Orders scored`) AS orders_count ",
        "FROM welch.demand_planning_demo.mv_late_delivery_risk ",
        "WHERE order_date >= date_sub(current_date(), 28) ",
        "GROUP BY customer_region ",
        "ORDER BY avg_late_risk DESC"
      ]
    },
    {
      "name": "late_risk_hotspots",
      "displayName": "Late-Risk Hotspots (4w)",
      "queryLines": [
        "SELECT customer_region, sku_family, ",
        "       MEASURE(`Avg late-risk prob`) AS avg_late_risk_prob ",
        "FROM welch.demand_planning_demo.mv_late_delivery_risk ",
        "WHERE order_date >= date_sub(current_date(), 28) ",
        "GROUP BY customer_region, sku_family ",
        "ORDER BY avg_late_risk_prob DESC"
      ]
    },
    {
      "name": "late_risk_orders",
      "displayName": "Highest Late-Risk Orders (30d)",
      "queryLines": [
        "SELECT order_date, customer_region, channel, plant_id, dc_id, ",
        "       sku_family, units_ordered, days_to_request, ",
        "       late_risk_prob, late_risk_flag, actual_late ",
        "FROM welch.demand_planning_demo.order_late_risk_scored_ml ",
        "WHERE order_date >= date_sub(current_date(), 30) ",
        "ORDER BY late_risk_prob DESC ",
        "LIMIT 50"
      ]
    },
    {
      "name": "demand_vs_forecast",
      "displayName": "Demand vs Forecast (Weekly)",
      "queryLines": [
        "SELECT a.week, a.sku_family, a.region, a.actual_units, f.forecast_units ",
        "FROM welch.demand_planning_demo.weekly_demand_actual a ",
        "LEFT JOIN welch.demand_planning_demo.demand_forecast f USING (week, sku_family, region) ",
        "WHERE a.week >= date_sub(current_date(), 180) AND (:fc_region IS NULL OR a.region = :fc_region) AND (:fc_sku_family IS NULL OR a.sku_family = :fc_sku_family) ",
        "ORDER BY a.week"
      ]
    },
    {
      "name": "demand_by_region",
      "displayName": "Demand by Region (Weekly)",
      "queryLines": [
        "SELECT week, region, SUM(actual_units) AS total_units ",
        "FROM welch.demand_planning_demo.weekly_demand_actual ",
        "WHERE week >= date_sub(current_date(), 91) ",
        "GROUP BY week, region ",
        "ORDER BY week, region"
      ]
    },
    {
      "name": "kpi_by_region",
      "displayName": "KPIs by Region (13w)",
      "queryLines": [
        "SELECT region, ",
        "       MEASURE(`OTIF`) AS otif_rate, ",
        "       MEASURE(`Freight $/ton`) AS freight_cost_per_ton, ",
        "       MEASURE(`CO2 kg/ton`) AS co2_kg_per_ton ",
        "FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "WHERE week >= date_sub(current_date(), 91) ",
        "GROUP BY region ",
        "ORDER BY region"
      ]
    },
    {
      "name": "premium_freight_by_lane",
      "displayName": "Premium Freight by Lane",
      "queryLines": [
        "SELECT CONCAT(plant_id, ' ‚Üí ', dc_id) AS lane, ",
        "       MEASURE(`Premium freight %`) AS premium_freight_pct, ",
        "       MEASURE(`CO2 kg/ton`) AS co2_impact ",
        "FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "WHERE week >= date_sub(current_date(), 91) AND (:selected_region IS NULL OR region = :selected_region) ",
        "GROUP BY plant_id, dc_id ",
        "HAVING MEASURE(`Premium freight %`) > 0.05 ",
        "ORDER BY premium_freight_pct DESC ",
        "LIMIT 15"
      ]
    },
    {
      "name": "network_locations",
      "displayName": "ADS Network Locations",
      "queryLines": [
        "SELECT 'Plant' AS location_type, plant_id AS location_id, plant_name AS location_name, ",
        "       plant_city AS city, plant_state AS state, plant_lat AS lat, plant_lon AS lon, plant_region AS region ",
        "FROM welch.demand_planning_demo.silver_plant_locations ",
        "UNION ALL ",
        "SELECT 'DC' AS location_type, dc_id AS location_id, dc_name AS location_name, ",
        "       dc_city AS city, dc_state AS state, dc_lat AS lat, dc_lon AS lon, dc_region AS region ",
        "FROM welch.demand_planning_demo.silver_dc_locations"
      ]
    },
    {
      "name": "lanes_with_coords",
      "displayName": "Freight Lanes with Coordinates",
      "queryLines": [
        "WITH lanes AS ( ",
        "  SELECT plant_id, dc_id, ",
        "         MEASURE(`Freight $/ton`) AS freight_cost, ",
        "         MEASURE(`CO2 kg/ton`) AS co2_kg_per_ton ",
        "  FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "  WHERE week >= date_sub(current_date(), 91) ",
        "  GROUP BY plant_id, dc_id ",
        ") ",
        "SELECT l.plant_id, l.dc_id, ",
        "       p.plant_name, p.plant_lat, p.plant_lon, ",
        "       d.dc_name, d.dc_lat, d.dc_lon, ",
        "       l.freight_cost, l.co2_kg_per_ton ",
        "FROM lanes l ",
        "JOIN welch.demand_planning_demo.silver_plant_locations p ON l.plant_id = p.plant_id ",
        "JOIN welch.demand_planning_demo.silver_dc_locations d ON l.dc_id = d.dc_id ",
        "ORDER BY freight_cost DESC ",
        "LIMIT 20"
      ]
    },
    {
      "name": "plant_count_dataset",
      "displayName": "Plant Count",
      "queryLines": [
        "SELECT COUNT(*) AS plant_count FROM welch.demand_planning_demo.silver_plant_locations"
      ]
    },
    {
      "name": "dc_count_dataset",
      "displayName": "DC Count",
      "queryLines": [
        "SELECT COUNT(*) AS dc_count FROM welch.demand_planning_demo.silver_dc_locations"
      ]
    },
    {
      "name": "all_facilities",
      "displayName": "All Facilities",
      "queryLines": [
        "SELECT 'Plant' AS facility_type, plant_id AS id, plant_name AS name, ",
        "       plant_city AS city, plant_state AS state, plant_region AS region ",
        "FROM welch.demand_planning_demo.silver_plant_locations ",
        "UNION ALL ",
        "SELECT 'DC' AS facility_type, dc_id AS id, dc_name AS name, ",
        "       dc_city AS city, dc_state AS state, dc_region AS region ",
        "FROM welch.demand_planning_demo.silver_dc_locations ",
        "ORDER BY facility_type, region, state"
      ]
    },
    {
      "name": "top_freight_lanes",
      "displayName": "Top Freight Lanes",
      "queryLines": [
        "WITH lanes AS ( ",
        "  SELECT plant_id, dc_id, ",
        "         MEASURE(`Freight $/ton`) AS freight_cost, ",
        "         MEASURE(`CO2 kg/ton`) AS co2_kg_per_ton ",
        "  FROM welch.demand_planning_demo.mv_control_tower_kpis ",
        "  WHERE week >= date_sub(current_date(), 91) ",
        "  GROUP BY plant_id, dc_id ",
        ") ",
        "SELECT p.plant_name, d.dc_name, ",
        "       ROUND(l.freight_cost, 2) AS freight_cost, ",
        "       ROUND(l.co2_kg_per_ton, 1) AS co2_kg_per_ton ",
        "FROM lanes l ",
        "JOIN welch.demand_planning_demo.silver_plant_locations p ON l.plant_id = p.plant_id ",
        "JOIN welch.demand_planning_demo.silver_dc_locations d ON l.dc_id = d.dc_id ",
        "ORDER BY l.freight_cost DESC ",
        "LIMIT 15"
      ]
    },
    {
      "name": "order_volume_kpis",
      "displayName": "Order Volume KPIs (13w)",
      "queryLines": [
        "SELECT COUNT(*) AS total_orders, ",
        "       COUNT(DISTINCT customer_id) AS unique_customers, ",
        "       COUNT(DISTINCT channel) AS sales_channels, ",
        "       SUM(units_ordered) AS total_units_ordered ",
        "FROM welch.demand_planning_demo.silver_erp_orders ",
        "WHERE order_date >= date_sub(current_date(), 91)"
      ]
    },
    {
      "name": "service_performance_kpis",
      "displayName": "Service Performance KPIs (13w)",
      "queryLines": [
        "SELECT ",
        "  ROUND(AVG(CASE WHEN is_cancelled = FALSE AND is_backorder = FALSE AND is_otif = TRUE THEN 1.0 ELSE 0.0 END), 4) AS perfect_order_rate, ",
        "  ROUND(AVG(CASE WHEN is_cancelled = TRUE THEN 1.0 ELSE 0.0 END), 4) AS cancellation_rate, ",
        "  ROUND(AVG(CASE WHEN is_backorder = TRUE THEN 1.0 ELSE 0.0 END), 4) AS backorder_rate ",
        "FROM welch.demand_planning_demo.silver_erp_orders ",
        "WHERE order_date >= date_sub(current_date(), 91)"
      ]
    },
    {
      "name": "transport_mode_comparison",
      "displayName": "Transportation Mode Comparison",
      "queryLines": [
        "SELECT mode AS transport_mode, ",
        "       ROUND(SUM(freight_cost_usd) / NULLIF(SUM(total_weight_tons), 0), 2) AS freight_cost_per_ton, ",
        "       ROUND(SUM(co2_kg) / NULLIF(SUM(total_weight_tons), 0), 2) AS co2_kg_per_ton, ",
        "       SUM(total_weight_tons) AS tons_shipped ",
        "FROM welch.demand_planning_demo.silver_tms_shipments ",
        "WHERE ship_date >= date_sub(current_date(), 91) ",
        "GROUP BY mode ",
        "ORDER BY tons_shipped DESC"
      ]
    },
    {
      "name": "product_family_mix",
      "displayName": "Product Family Mix (13w)",
      "queryLines": [
        "SELECT sku_family, ",
        "       SUM(units_ordered) AS total_units, ",
        "       ROUND(SUM(units_ordered) * 100.0 / SUM(SUM(units_ordered)) OVER (), 1) AS pct_of_total ",
        "FROM welch.demand_planning_demo.silver_erp_orders ",
        "WHERE order_date >= date_sub(current_date(), 91) ",
        "GROUP BY sku_family ",
        "ORDER BY total_units DESC"
      ]
    },
    {
      "name": "orders_by_channel",
      "displayName": "Orders by Sales Channel",
      "queryLines": [
        "SELECT channel AS sales_channel, ",
        "       COUNT(*) AS order_count, ",
        "       SUM(units_ordered) AS units_ordered, ",
        "       ROUND(AVG(CASE WHEN is_otif = TRUE THEN 1.0 ELSE 0.0 END), 4) AS otif_rate ",
        "FROM welch.demand_planning_demo.silver_erp_orders ",
        "WHERE order_date >= date_sub(current_date(), 91) ",
        "GROUP BY channel ",
        "ORDER BY order_count DESC"
      ]
    }
  ],
  "pages": [
    {
      "name": "Executive_Overview",
      "displayName": "üéØ Executive Overview",
      "layout": [
        {
          "widget": {
            "name": "exec_header",
            "multilineTextboxSpec": {
              "lines": [
                "# üéØ Executive Overview | Demand Planning Control Tower"
              ]
            }
          },
          "position": { "x": 0, "y": 0, "width": 12, "height": 1 }
        },
        {
          "widget": {
            "name": "kpi_otif",
            "queries": [{ "name": "main_query", "query": { "datasetName": "kpi_snapshot", "fields": [{ "name": "otif_rate", "expression": "`otif_rate`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "otif_rate", "displayName": "OTIF Rate" }},
              "frame": { "title": "‚úÖ OTIF", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_mape",
            "queries": [{ "name": "main_query", "query": { "datasetName": "kpi_snapshot", "fields": [{ "name": "mape", "expression": "`mape`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "mape", "displayName": "MAPE" }},
              "frame": { "title": "üìä Forecast MAPE", "showTitle": true }
            }
          },
          "position": { "x": 2, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_freight",
            "queries": [{ "name": "main_query", "query": { "datasetName": "kpi_snapshot", "fields": [{ "name": "freight_cost_per_ton", "expression": "`freight_cost_per_ton`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "freight_cost_per_ton", "displayName": "$/ton" }},
              "frame": { "title": "üöö Freight Cost", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_co2",
            "queries": [{ "name": "main_query", "query": { "datasetName": "kpi_snapshot", "fields": [{ "name": "co2_kg_per_ton", "expression": "`co2_kg_per_ton`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "co2_kg_per_ton", "displayName": "kg/ton" }},
              "frame": { "title": "üåø CO‚ÇÇ Emissions", "showTitle": true }
            }
          },
          "position": { "x": 6, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_late_risk",
            "queries": [{ "name": "main_query", "query": { "datasetName": "kpi_snapshot", "fields": [{ "name": "late_risk_prob", "expression": "`late_risk_prob`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "late_risk_prob", "displayName": "Avg Risk" }},
              "frame": { "title": "‚ö†Ô∏è Late Risk", "showTitle": true }
            }
          },
          "position": { "x": 8, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_premium",
            "queries": [{ "name": "main_query", "query": { "datasetName": "kpi_snapshot", "fields": [{ "name": "premium_freight_pct", "expression": "`premium_freight_pct`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "premium_freight_pct", "displayName": "Premium %" }},
              "frame": { "title": "üö® Premium Freight", "showTitle": true }
            }
          },
          "position": { "x": 10, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_orders",
            "queries": [{ "name": "main_query", "query": { "datasetName": "order_volume_kpis", "fields": [{ "name": "total_orders", "expression": "`total_orders`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "total_orders", "displayName": "Orders" }},
              "frame": { "title": "üìã Total Orders", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 3, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_customers",
            "queries": [{ "name": "main_query", "query": { "datasetName": "order_volume_kpis", "fields": [{ "name": "unique_customers", "expression": "`unique_customers`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "unique_customers", "displayName": "Customers" }},
              "frame": { "title": "üë• Customers", "showTitle": true }
            }
          },
          "position": { "x": 2, "y": 3, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_perfect_order",
            "queries": [{ "name": "main_query", "query": { "datasetName": "service_performance_kpis", "fields": [{ "name": "perfect_order_rate", "expression": "`perfect_order_rate`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "perfect_order_rate", "displayName": "Rate" }},
              "frame": { "title": "üéØ Perfect Order", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 3, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_backorder",
            "queries": [{ "name": "main_query", "query": { "datasetName": "service_performance_kpis", "fields": [{ "name": "backorder_rate", "expression": "`backorder_rate`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "backorder_rate", "displayName": "Rate" }},
              "frame": { "title": "üì¶ Backorder", "showTitle": true }
            }
          },
          "position": { "x": 6, "y": 3, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "kpi_cancellation",
            "queries": [{ "name": "main_query", "query": { "datasetName": "service_performance_kpis", "fields": [{ "name": "cancellation_rate", "expression": "`cancellation_rate`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "cancellation_rate", "displayName": "Rate" }},
              "frame": { "title": "‚ùå Cancellation", "showTitle": true }
            }
          },
          "position": { "x": 8, "y": 3, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "product_mix_bar",
            "queries": [{ "name": "main_query", "query": { "datasetName": "product_family_mix", "fields": [
              { "name": "sku_family", "expression": "`sku_family`" },
              { "name": "pct_of_total", "expression": "`pct_of_total`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "pct_of_total", "displayName": "% of Volume", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "sku_family", "displayName": "Product Family", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üìä Product Mix", "showTitle": true }
            }
          },
          "position": { "x": 10, "y": 3, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "otif_trend_line",
            "queries": [{ "name": "main_query", "query": { "datasetName": "otif_trend", "fields": [
              { "name": "week", "expression": "`week`" },
              { "name": "otif_rate", "expression": "`otif_rate`" },
              { "name": "region", "expression": "`region`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "line",
              "encodings": {
                "x": { "fieldName": "week", "displayName": "Week", "scale": { "type": "temporal" }},
                "y": { "fieldName": "otif_rate", "displayName": "OTIF", "scale": { "type": "quantitative" }},
                "color": { "fieldName": "region", "displayName": "Region" }
              },
              "frame": { "title": "üìà OTIF Trend by Region", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 5, "width": 6, "height": 4 }
        },
        {
          "widget": {
            "name": "demand_by_region_area",
            "queries": [{ "name": "main_query", "query": { "datasetName": "demand_by_region", "fields": [
              { "name": "week", "expression": "`week`" },
              { "name": "region", "expression": "`region`" },
              { "name": "total_units", "expression": "`total_units`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "area",
              "encodings": {
                "x": { "fieldName": "week", "displayName": "Week", "scale": { "type": "temporal" }},
                "y": { "fieldName": "total_units", "displayName": "Units", "scale": { "type": "quantitative" }},
                "color": { "fieldName": "region", "displayName": "Region" }
              },
              "frame": { "title": "üì¶ Demand by Region", "showTitle": true }
            }
          },
          "position": { "x": 6, "y": 5, "width": 6, "height": 4 }
        },
        {
          "widget": {
            "name": "late_risk_heatmap",
            "queries": [{ "name": "main_query", "query": { "datasetName": "late_risk_hotspots", "fields": [
              { "name": "customer_region", "expression": "`customer_region`" },
              { "name": "sku_family", "expression": "`sku_family`" },
              { "name": "avg_late_risk_prob", "expression": "`avg_late_risk_prob`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "heatmap",
              "encodings": {
                "x": { "fieldName": "customer_region", "displayName": "Region", "scale": { "type": "categorical" }},
                "y": { "fieldName": "sku_family", "displayName": "Family", "scale": { "type": "categorical" }},
                "color": { "fieldName": "avg_late_risk_prob", "displayName": "Risk", "scale": { "type": "quantitative" }}
              },
              "frame": { "title": "ü§ñ ML Late-Risk Hotspots", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 9, "width": 4, "height": 4 }
        },
        {
          "widget": {
            "name": "region_kpis",
            "queries": [{ "name": "main_query", "query": { "datasetName": "kpi_by_region", "fields": [
              { "name": "region", "expression": "`region`" },
              { "name": "otif_rate", "expression": "`otif_rate`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "otif_rate", "displayName": "OTIF", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "region", "displayName": "Region", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üó∫Ô∏è OTIF by Region", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 9, "width": 4, "height": 4 }
        },
        {
          "widget": {
            "name": "freight_lanes_bar",
            "queries": [{ "name": "main_query", "query": { "datasetName": "freight_lanes_13w", "fields": [
              { "name": "freight_cost_per_ton", "expression": "`freight_cost_per_ton`" },
              { "name": "lane", "expression": "concat(`plant_id`, ' ‚Üí ', `dc_id`)" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "freight_cost_per_ton", "displayName": "$/ton", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "lane", "displayName": "Lane", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üöö Highest-Cost Lanes", "showTitle": true }
            }
          },
          "position": { "x": 8, "y": 9, "width": 4, "height": 4 }
        },
        {
          "widget": {
            "name": "channel_performance",
            "queries": [{ "name": "main_query", "query": { "datasetName": "orders_by_channel", "fields": [
              { "name": "sales_channel", "expression": "`sales_channel`" },
              { "name": "otif_rate", "expression": "`otif_rate`" },
              { "name": "order_count", "expression": "`order_count`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "otif_rate", "displayName": "OTIF Rate", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "sales_channel", "displayName": "Channel", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üìä OTIF by Sales Channel", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 13, "width": 6, "height": 3 }
        },
        {
          "widget": {
            "name": "transport_mode_chart",
            "queries": [{ "name": "main_query", "query": { "datasetName": "transport_mode_comparison", "fields": [
              { "name": "transport_mode", "expression": "`transport_mode`" },
              { "name": "freight_cost_per_ton", "expression": "`freight_cost_per_ton`" },
              { "name": "co2_kg_per_ton", "expression": "`co2_kg_per_ton`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "freight_cost_per_ton", "displayName": "$/ton", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "transport_mode", "displayName": "Mode", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üöõ Cost by Transport Mode", "showTitle": true }
            }
          },
          "position": { "x": 6, "y": 13, "width": 6, "height": 3 }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "Sustainability",
      "displayName": "üåø Sustainability",
      "layout": [
        {
          "widget": {
            "name": "sust_header",
            "multilineTextboxSpec": {
              "lines": [
                "# üåø Sustainability Dashboard",
                "",
                "**Track environmental impact across transport and production** | CO‚ÇÇ emissions, energy intensity, and premium freight reduction opportunities"
              ]
            }
          },
          "position": { "x": 0, "y": 0, "width": 6, "height": 1 }
        },
        {
          "widget": {
            "name": "region_filter_widget",
            "queries": [{ "name": "main_query", "query": { "datasetName": "region_list", "fields": [
              { "name": "region", "expression": "`region`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "filter-single-select",
              "encodings": {
                "fields": [{ "fieldName": "region", "displayName": "Region" }]
              },
              "frame": { "title": "üó∫Ô∏è Filter by Region", "showTitle": true }
            },
            "parameterMappings": {
              "selected_region": "region"
            }
          },
          "position": { "x": 6, "y": 0, "width": 2, "height": 1 }
        },
        {
          "widget": {
            "name": "sust_co2_kpi",
            "queries": [{ "name": "main_query", "query": { "datasetName": "sust_kpi_snapshot", "fields": [{ "name": "co2_kg_per_ton", "expression": "`co2_kg_per_ton`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "co2_kg_per_ton", "displayName": "kg/ton" }},
              "frame": { "title": "üåç CO‚ÇÇ per Ton Shipped", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "sust_energy_kpi",
            "queries": [{ "name": "main_query", "query": { "datasetName": "sust_kpi_snapshot", "fields": [{ "name": "energy_kwh_per_unit", "expression": "`energy_kwh_per_unit`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "energy_kwh_per_unit", "displayName": "kWh/unit" }},
              "frame": { "title": "‚ö° Energy Intensity", "showTitle": true }
            }
          },
          "position": { "x": 2, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "sust_premium_kpi",
            "queries": [{ "name": "main_query", "query": { "datasetName": "sust_kpi_snapshot", "fields": [{ "name": "premium_freight_pct", "expression": "`premium_freight_pct`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "premium_freight_pct", "displayName": "%" }},
              "frame": { "title": "üö® Premium Freight %", "showTitle": true, "showDescription": true, "description": "Higher emissions" }
            }
          },
          "position": { "x": 4, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "sust_freight_kpi",
            "queries": [{ "name": "main_query", "query": { "datasetName": "sust_kpi_snapshot", "fields": [{ "name": "freight_cost_per_ton", "expression": "`freight_cost_per_ton`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "freight_cost_per_ton", "displayName": "$/ton" }},
              "frame": { "title": "üí∞ Transport Cost", "showTitle": true }
            }
          },
          "position": { "x": 6, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "sust_trend",
            "queries": [{ "name": "main_query", "query": { "datasetName": "sustainability_trend", "fields": [
              { "name": "week", "expression": "`week`" },
              { "name": "co2_kg_per_ton", "expression": "`co2_kg_per_ton`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "area",
              "encodings": {
                "x": { "fieldName": "week", "displayName": "Week", "scale": { "type": "temporal" }},
                "y": { "fieldName": "co2_kg_per_ton", "displayName": "CO‚ÇÇ kg/ton", "scale": { "type": "quantitative" }}
              },
              "frame": { "title": "üìâ CO‚ÇÇ Intensity Trend", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 3, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "energy_trend",
            "queries": [{ "name": "main_query", "query": { "datasetName": "sustainability_trend", "fields": [
              { "name": "week", "expression": "`week`" },
              { "name": "energy_kwh_per_unit", "expression": "`energy_kwh_per_unit`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "line",
              "encodings": {
                "x": { "fieldName": "week", "displayName": "Week", "scale": { "type": "temporal" }},
                "y": { "fieldName": "energy_kwh_per_unit", "displayName": "kWh/unit", "scale": { "type": "quantitative" }}
              },
              "frame": { "title": "‚ö° Energy Intensity Trend", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 3, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "co2_by_region_bar",
            "queries": [{ "name": "main_query", "query": { "datasetName": "co2_by_region", "fields": [
              { "name": "region", "expression": "`region`" },
              { "name": "co2_kg_per_ton", "expression": "`co2_kg_per_ton`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "co2_kg_per_ton", "displayName": "CO‚ÇÇ kg/ton", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "region", "displayName": "Region", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üó∫Ô∏è CO‚ÇÇ by Region", "showTitle": true },
              "interactions": {
                "filterOnClick": {
                  "type": "CROSS_FILTER",
                  "columnName": "region"
                }
              }
            }
          },
          "position": { "x": 0, "y": 6, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "energy_by_plant_bar",
            "queries": [{ "name": "main_query", "query": { "datasetName": "energy_by_plant", "fields": [
              { "name": "plant_id", "expression": "`plant_id`" },
              { "name": "energy_kwh_per_unit", "expression": "`energy_kwh_per_unit`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "energy_kwh_per_unit", "displayName": "kWh/unit", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "plant_id", "displayName": "Plant", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üè≠ Energy by Plant", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 6, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "premium_lanes",
            "queries": [{ "name": "main_query", "query": { "datasetName": "premium_freight_by_lane", "fields": [
              { "name": "lane", "expression": "`lane`" },
              { "name": "premium_freight_pct", "expression": "`premium_freight_pct`" },
              { "name": "co2_impact", "expression": "`co2_impact`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "premium_freight_pct", "displayName": "Premium %", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "lane", "displayName": "Lane", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üö® Premium Freight Lanes (emission hotspots)", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 9, "width": 8, "height": 3 }
        },
        {
          "widget": {
            "name": "mode_cost_comparison",
            "queries": [{ "name": "main_query", "query": { "datasetName": "transport_mode_comparison", "fields": [
              { "name": "transport_mode", "expression": "`transport_mode`" },
              { "name": "freight_cost_per_ton", "expression": "`freight_cost_per_ton`" },
              { "name": "tons_shipped", "expression": "`tons_shipped`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "freight_cost_per_ton", "displayName": "$/ton", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "transport_mode", "displayName": "Mode", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üöõ Freight Cost by Transport Mode", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 12, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "mode_co2_comparison",
            "queries": [{ "name": "main_query", "query": { "datasetName": "transport_mode_comparison", "fields": [
              { "name": "transport_mode", "expression": "`transport_mode`" },
              { "name": "co2_kg_per_ton", "expression": "`co2_kg_per_ton`" },
              { "name": "tons_shipped", "expression": "`tons_shipped`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "co2_kg_per_ton", "displayName": "kg CO‚ÇÇ/ton", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "transport_mode", "displayName": "Mode", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üå± CO‚ÇÇ Emissions by Transport Mode", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 12, "width": 4, "height": 3 }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "Forecasting",
      "displayName": "üìä Forecasting",
      "layout": [
        {
          "widget": {
            "name": "forecast_header",
            "multilineTextboxSpec": {
              "lines": [
                "# üìä Demand Forecasting | AI-powered accuracy tracking and bias analysis"
              ]
            }
          },
          "position": { "x": 0, "y": 0, "width": 4, "height": 1 }
        },
        {
          "widget": {
            "name": "fc_region_filter",
            "queries": [{ "name": "main_query", "query": { "datasetName": "fc_region_list", "fields": [
              { "name": "region", "expression": "`region`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "filter-single-select",
              "encodings": {
                "fields": [{ "fieldName": "region", "displayName": "Region" }]
              },
              "frame": { "title": "üó∫Ô∏è Region", "showTitle": true }
            },
            "parameterMappings": { "fc_region": "region" }
          },
          "position": { "x": 4, "y": 0, "width": 2, "height": 1 }
        },
        {
          "widget": {
            "name": "fc_family_filter",
            "queries": [{ "name": "main_query", "query": { "datasetName": "fc_sku_family_list", "fields": [
              { "name": "sku_family", "expression": "`sku_family`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "filter-single-select",
              "encodings": {
                "fields": [{ "fieldName": "sku_family", "displayName": "Product" }]
              },
              "frame": { "title": "üì¶ Product Family", "showTitle": true }
            },
            "parameterMappings": { "fc_sku_family": "sku_family" }
          },
          "position": { "x": 6, "y": 0, "width": 2, "height": 1 }
        },
        {
          "widget": {
            "name": "fc_mape_kpi",
            "queries": [{ "name": "main_query", "query": { "datasetName": "fc_kpi_snapshot", "fields": [
              { "name": "mape", "expression": "`mape`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "mape", "displayName": "MAPE" }},
              "frame": { "title": "üìä Avg MAPE (13w)", "showTitle": true, "showDescription": true, "description": "Lower is better" }
            }
          },
          "position": { "x": 0, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "fc_bias_kpi",
            "queries": [{ "name": "main_query", "query": { "datasetName": "forecast_bias_summary", "fields": [
              { "name": "avg_bias_pct", "expression": "`avg_bias_pct`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "avg_bias_pct", "displayName": "%" }},
              "frame": { "title": "üìà Avg Forecast Bias", "showTitle": true, "showDescription": true, "description": "+ over / - under" }
            }
          },
          "position": { "x": 2, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "fc_over_count",
            "queries": [{ "name": "main_query", "query": { "datasetName": "forecast_bias_summary", "fields": [
              { "name": "over_forecast_count", "expression": "`over_forecast_count`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "over_forecast_count", "displayName": "Count" }},
              "frame": { "title": "‚¨ÜÔ∏è Over-Forecasts", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "fc_under_count",
            "queries": [{ "name": "main_query", "query": { "datasetName": "forecast_bias_summary", "fields": [
              { "name": "under_forecast_count", "expression": "`under_forecast_count`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "under_forecast_count", "displayName": "Count" }},
              "frame": { "title": "‚¨áÔ∏è Under-Forecasts", "showTitle": true }
            }
          },
          "position": { "x": 6, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "mape_trend_line",
            "queries": [{ "name": "main_query", "query": { "datasetName": "mape_trend", "fields": [
              { "name": "week", "expression": "`week`" },
              { "name": "mape", "expression": "`mape`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "line",
              "encodings": {
                "x": { "fieldName": "week", "displayName": "Week", "scale": { "type": "temporal" }},
                "y": { "fieldName": "mape", "displayName": "MAPE", "scale": { "type": "quantitative" }}
              },
              "frame": { "title": "üìâ MAPE Trend Over Time", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 3, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "demand_forecast_combo",
            "queries": [{ "name": "main_query", "query": { "datasetName": "demand_vs_forecast", "fields": [
              { "name": "week", "expression": "`week`" },
              { "name": "actual_units", "expression": "SUM(`actual_units`)" },
              { "name": "forecast_units", "expression": "SUM(`forecast_units`)" }
            ], "disaggregated": false }}],
            "spec": {
              "version": 3, "widgetType": "line",
              "encodings": {
                "x": { "fieldName": "week", "displayName": "Week", "scale": { "type": "temporal" }},
                "y": { "fieldName": "actual_units", "displayName": "Actual", "scale": { "type": "quantitative" }}
              },
              "frame": { "title": "üì¶ Demand vs Forecast", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 3, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "mape_by_region_bar",
            "queries": [{ "name": "main_query", "query": { "datasetName": "mape_by_region", "fields": [
              { "name": "region", "expression": "`region`" },
              { "name": "mape", "expression": "`mape`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "mape", "displayName": "MAPE", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "region", "displayName": "Region", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üó∫Ô∏è MAPE by Region", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 6, "width": 2, "height": 3 }
        },
        {
          "widget": {
            "name": "mape_by_family_bar",
            "queries": [{ "name": "main_query", "query": { "datasetName": "mape_by_family", "fields": [
              { "name": "sku_family", "expression": "`sku_family`" },
              { "name": "mape", "expression": "`mape`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "mape", "displayName": "MAPE", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "sku_family", "displayName": "Product", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üì¶ MAPE by Product", "showTitle": true }
            }
          },
          "position": { "x": 2, "y": 6, "width": 2, "height": 3 }
        },
        {
          "widget": {
            "name": "mape_heatmap",
            "queries": [{ "name": "main_query", "query": { "datasetName": "mape_by_family_region", "fields": [
              { "name": "sku_family", "expression": "`sku_family`" },
              { "name": "region", "expression": "`region`" },
              { "name": "mape", "expression": "`mape`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "heatmap",
              "encodings": {
                "x": { "fieldName": "region", "displayName": "Region", "scale": { "type": "categorical" }},
                "y": { "fieldName": "sku_family", "displayName": "Product", "scale": { "type": "categorical" }},
                "color": { "fieldName": "mape", "displayName": "MAPE", "scale": { "type": "quantitative" }}
              },
              "frame": { "title": "üéØ Accuracy Heatmap (Product √ó Region)", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 6, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "worst_forecasts_table",
            "queries": [{ "name": "main_query", "query": { "datasetName": "worst_forecasts", "fields": [
              { "name": "sku_family", "expression": "`sku_family`" },
              { "name": "region", "expression": "`region`" },
              { "name": "mape", "expression": "`mape`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "sku_family", "type": "string", "displayAs": "string", "visible": true, "order": 1, "title": "Product" },
                  { "fieldName": "region", "type": "string", "displayAs": "string", "visible": true, "order": 2, "title": "Region" },
                  { "fieldName": "mape", "type": "float", "displayAs": "number", "numberFormat": "#,##0.00", "visible": true, "order": 3, "title": "MAPE" }
                ]
              },
              "itemsPerPage": 10,
              "condensed": true,
              "frame": { "title": "üî• Worst Performing Combinations", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 9, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "forecast_bias_trend",
            "queries": [{ "name": "main_query", "query": { "datasetName": "forecast_bias", "fields": [
              { "name": "week", "expression": "`week`" },
              { "name": "bias_pct", "expression": "AVG(`bias_pct`)" }
            ], "disaggregated": false }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "week", "displayName": "Week", "scale": { "type": "temporal" }},
                "y": { "fieldName": "bias_pct", "displayName": "Bias %", "scale": { "type": "quantitative" }}
              },
              "frame": { "title": "üìä Weekly Forecast Bias Trend", "showTitle": true, "showDescription": true, "description": "+ over-forecast / - under-forecast" }
            }
          },
          "position": { "x": 4, "y": 9, "width": 4, "height": 3 }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "Operations_Risk",
      "displayName": "üöö Operations & Risk",
      "layout": [
        {
          "widget": {
            "name": "ops_header",
            "multilineTextboxSpec": {
              "lines": [
                "# üöö Late-Delivery Risk | ML-powered order risk scoring"
              ]
            }
          },
          "position": { "x": 0, "y": 0, "width": 8, "height": 1 }
        },
        {
          "widget": {
            "name": "risk_kpi",
            "queries": [{ "name": "main_query", "query": { "datasetName": "kpi_snapshot", "fields": [{ "name": "late_risk_prob", "expression": "`late_risk_prob`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "late_risk_prob", "displayName": "Risk" }},
              "frame": { "title": "‚ö†Ô∏è Avg Late Risk", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "otif_kpi",
            "queries": [{ "name": "main_query", "query": { "datasetName": "kpi_snapshot", "fields": [{ "name": "otif_rate", "expression": "`otif_rate`" }], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "otif_rate", "displayName": "OTIF" }},
              "frame": { "title": "‚úÖ OTIF Rate", "showTitle": true }
            }
          },
          "position": { "x": 2, "y": 1, "width": 2, "height": 2 }
        },
        {
          "widget": {
            "name": "late_risk_trend",
            "queries": [{ "name": "main_query", "query": { "datasetName": "late_risk_trend", "fields": [
              { "name": "order_week", "expression": "`order_week`" },
              { "name": "avg_late_risk", "expression": "`avg_late_risk`" },
              { "name": "actual_late_rate", "expression": "`actual_late_rate`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "line",
              "encodings": {
                "x": { "fieldName": "order_week", "displayName": "Week", "scale": { "type": "temporal" }},
                "y": { "fieldName": "avg_late_risk", "displayName": "Risk", "scale": { "type": "quantitative" }}
              },
              "frame": { "title": "üìà Risk Trend", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 1, "width": 4, "height": 2 }
        },
        {
          "widget": {
            "name": "risk_by_region",
            "queries": [{ "name": "main_query", "query": { "datasetName": "late_risk_by_region", "fields": [
              { "name": "customer_region", "expression": "`customer_region`" },
              { "name": "avg_late_risk", "expression": "`avg_late_risk`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "avg_late_risk", "displayName": "Risk", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "customer_region", "displayName": "Region", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üó∫Ô∏è Risk by Region", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 3, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "risk_hotspots",
            "queries": [{ "name": "main_query", "query": { "datasetName": "late_risk_hotspots", "fields": [
              { "name": "customer_region", "expression": "`customer_region`" },
              { "name": "sku_family", "expression": "`sku_family`" },
              { "name": "avg_late_risk_prob", "expression": "`avg_late_risk_prob`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 3, "widgetType": "heatmap",
              "encodings": {
                "x": { "fieldName": "customer_region", "displayName": "Region", "scale": { "type": "categorical" }},
                "y": { "fieldName": "sku_family", "displayName": "Product", "scale": { "type": "categorical" }},
                "color": { "fieldName": "avg_late_risk_prob", "displayName": "Risk", "scale": { "type": "quantitative" }}
              },
              "frame": { "title": "üéØ Risk Hotspots", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 3, "width": 4, "height": 3 }
        },
        {
          "widget": {
            "name": "late_risk_orders_table",
            "queries": [{ "name": "main_query", "query": { "datasetName": "late_risk_orders", "fields": [
              { "name": "order_date", "expression": "`order_date`" },
              { "name": "customer_region", "expression": "`customer_region`" },
              { "name": "sku_family", "expression": "`sku_family`" },
              { "name": "plant_id", "expression": "`plant_id`" },
              { "name": "dc_id", "expression": "`dc_id`" },
              { "name": "units_ordered", "expression": "`units_ordered`" },
              { "name": "late_risk_prob", "expression": "`late_risk_prob`" },
              { "name": "actual_late", "expression": "`actual_late`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "order_date", "type": "datetime", "displayAs": "datetime", "visible": true, "order": 1, "title": "Date" },
                  { "fieldName": "customer_region", "type": "string", "displayAs": "string", "visible": true, "order": 2, "title": "Region" },
                  { "fieldName": "sku_family", "type": "string", "displayAs": "string", "visible": true, "order": 3, "title": "Product" },
                  { "fieldName": "plant_id", "type": "string", "displayAs": "string", "visible": true, "order": 4, "title": "Plant" },
                  { "fieldName": "dc_id", "type": "string", "displayAs": "string", "visible": true, "order": 5, "title": "DC" },
                  { "fieldName": "units_ordered", "type": "integer", "displayAs": "number", "numberFormat": "#,##0", "visible": true, "order": 6, "title": "Units" },
                  { "fieldName": "late_risk_prob", "type": "float", "displayAs": "number", "numberFormat": "0.00", "visible": true, "order": 7, "title": "Risk Score" },
                  { "fieldName": "actual_late", "type": "boolean", "displayAs": "boolean", "visible": true, "order": 8, "title": "Late?" }
                ]
              },
              "itemsPerPage": 15,
              "condensed": true,
              "frame": { "title": "üî• High-Risk Orders (30d)", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 6, "width": 8, "height": 6 }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "Network",
      "displayName": "üó∫Ô∏è Network Map",
      "layout": [
        {
          "widget": {
            "name": "network_header",
            "multilineTextboxSpec": {
              "lines": [
                "# üó∫Ô∏è Supply Chain Network | Plants & Distribution Centers"
              ]
            }
          },
          "position": { "x": 0, "y": 0, "width": 4, "height": 1 }
        },
        {
          "widget": {
            "name": "plant_count",
            "queries": [{ "name": "main_query", "query": { "datasetName": "plant_count_dataset", "fields": [
              { "name": "plant_count", "expression": "`plant_count`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "plant_count", "displayName": "Plants" }},
              "frame": { "title": "üè≠ Manufacturing Plants", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 0, "width": 2, "height": 1 }
        },
        {
          "widget": {
            "name": "dc_count",
            "queries": [{ "name": "main_query", "query": { "datasetName": "dc_count_dataset", "fields": [
              { "name": "dc_count", "expression": "`dc_count`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "counter",
              "encodings": { "value": { "fieldName": "dc_count", "displayName": "DCs" }},
              "frame": { "title": "üì¶ Distribution Centers", "showTitle": true }
            }
          },
          "position": { "x": 6, "y": 0, "width": 2, "height": 1 }
        },
        {
          "widget": {
            "name": "facilities_by_region",
            "queries": [{ "name": "main_query", "query": { "datasetName": "all_facilities", "fields": [
              { "name": "region", "expression": "`region`" },
              { "name": "facility_type", "expression": "`facility_type`" },
              { "name": "count", "expression": "COUNT(*)" }
            ], "disaggregated": false }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "count", "displayName": "Count", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "region", "displayName": "Region", "scale": { "type": "categorical" }},
                "color": { "fieldName": "facility_type", "displayName": "Type", "scale": { "type": "categorical" }}
              },
              "frame": { "title": "üìä Facilities by Region", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 1, "width": 4, "height": 4 }
        },
        {
          "widget": {
            "name": "facilities_by_state",
            "queries": [{ "name": "main_query", "query": { "datasetName": "all_facilities", "fields": [
              { "name": "state", "expression": "`state`" },
              { "name": "count", "expression": "COUNT(*)" }
            ], "disaggregated": false }}],
            "spec": {
              "version": 3, "widgetType": "bar",
              "encodings": {
                "x": { "fieldName": "count", "displayName": "Facilities", "scale": { "type": "quantitative" }},
                "y": { "fieldName": "state", "displayName": "State", "scale": { "type": "categorical" }, "sort": "descending" }
              },
              "frame": { "title": "üìç Facilities by State", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 1, "width": 4, "height": 4 }
        },
        {
          "widget": {
            "name": "facilities_table",
            "queries": [{ "name": "main_query", "query": { "datasetName": "all_facilities", "fields": [
              { "name": "facility_type", "expression": "`facility_type`" },
              { "name": "name", "expression": "`name`" },
              { "name": "city", "expression": "`city`" },
              { "name": "state", "expression": "`state`" },
              { "name": "region", "expression": "`region`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "facility_type", "type": "string", "displayAs": "string", "visible": true, "order": 1, "title": "Type" },
                  { "fieldName": "name", "type": "string", "displayAs": "string", "visible": true, "order": 2, "title": "Name" },
                  { "fieldName": "city", "type": "string", "displayAs": "string", "visible": true, "order": 3, "title": "City" },
                  { "fieldName": "state", "type": "string", "displayAs": "string", "visible": true, "order": 4, "title": "State" },
                  { "fieldName": "region", "type": "string", "displayAs": "string", "visible": true, "order": 5, "title": "Region" }
                ]
              },
              "itemsPerPage": 15,
              "condensed": true,
              "frame": { "title": "üè≠ All Facilities", "showTitle": true }
            }
          },
          "position": { "x": 0, "y": 5, "width": 4, "height": 5 }
        },
        {
          "widget": {
            "name": "lanes_table",
            "queries": [{ "name": "main_query", "query": { "datasetName": "top_freight_lanes", "fields": [
              { "name": "plant_name", "expression": "`plant_name`" },
              { "name": "dc_name", "expression": "`dc_name`" },
              { "name": "freight_cost", "expression": "`freight_cost`" },
              { "name": "co2_kg_per_ton", "expression": "`co2_kg_per_ton`" }
            ], "disaggregated": true }}],
            "spec": {
              "version": 2, "widgetType": "table",
              "encodings": {
                "columns": [
                  { "fieldName": "plant_name", "type": "string", "displayAs": "string", "visible": true, "order": 1, "title": "Plant" },
                  { "fieldName": "dc_name", "type": "string", "displayAs": "string", "visible": true, "order": 2, "title": "DC" },
                  { "fieldName": "freight_cost", "type": "float", "displayAs": "number", "numberFormat": "$#,##0.00", "visible": true, "order": 3, "title": "$/ton" },
                  { "fieldName": "co2_kg_per_ton", "type": "float", "displayAs": "number", "numberFormat": "#,##0.0", "visible": true, "order": 4, "title": "CO‚ÇÇ kg/ton" }
                ]
              },
              "itemsPerPage": 15,
              "condensed": true,
              "frame": { "title": "üöö Top Freight Lanes", "showTitle": true }
            }
          },
          "position": { "x": 4, "y": 5, "width": 4, "height": 5 }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    }
  ],
  "uiSettings": {
    "theme": {
      "widgetHeaderAlignment": "ALIGNMENT_UNSPECIFIED"
    },
    "applyModeEnabled": true,
    "crossFilteringEnabled": true
  }
}
